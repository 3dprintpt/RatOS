<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="RatOS RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="RatOS Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NQB0MHKGLP"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-NQB0MHKGLP",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="RatOS" href="/opensearch.xml"><title data-react-helmet="true">Connecting a 4028 fan | RatOS</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://os.ratrig.com/img/site-banner.png?bust=1"><meta data-react-helmet="true" name="twitter:image" content="https://os.ratrig.com/img/site-banner.png?bust=1"><meta data-react-helmet="true" property="og:url" content="https://os.ratrig.com/docs/guides/4028"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Connecting a 4028 fan | RatOS"><meta data-react-helmet="true" name="description" content="4028 server fans are becoming a popular option for part cooling because of their light weight and great pressure and flow rates. In this guide we&#x27;ll go over how to connect one and use it for part cooling. 4-pin fans usually aren&#x27;t used in 3d printers, and many boards only provide 2-pin ports, but fear not! There&#x27;s always a way."><meta data-react-helmet="true" property="og:description" content="4028 server fans are becoming a popular option for part cooling because of their light weight and great pressure and flow rates. In this guide we&#x27;ll go over how to connect one and use it for part cooling. 4-pin fans usually aren&#x27;t used in 3d printers, and many boards only provide 2-pin ports, but fear not! There&#x27;s always a way."><link data-react-helmet="true" rel="icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://os.ratrig.com/docs/guides/4028"><link data-react-helmet="true" rel="alternate" href="https://os.ratrig.com/docs/guides/4028" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://os.ratrig.com/docs/guides/4028" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1df9507f.css">
<link rel="preload" href="/assets/js/runtime~main.d3deb709.js" as="script">
<link rel="preload" href="/assets/js/main.a3347662.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logos/Logo-white.svg" alt="RatOS" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logos/Logo-white.svg" alt="RatOS" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title"></b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/changelog">Changelog</a><a href="https://github.com/sponsors/miklschmidt" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Donate/Sponsor<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/ratrig" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/Rat-OS/RatOS" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/introduction">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/configuration">Initial Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/slicers">Slicer Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manual-firmware-compilation">Manual Firmware Compilation</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/changelog#updating-from-v-coreos-rc2">Updating from V-CoreOS RC2</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/boards/btt/octopus-11-407">Supported Boards</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/printers/v-core-3">Supported Printers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/configuration/advanced-stepper-configuration">Configuration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/configuration/advanced-stepper-configuration">Advanced Stepper Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/configuration/includes-and-overrides">Includes &amp; Overrides</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/configuration/macros">Configuring RatOS Macros</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/guides/4028">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/guides/4028">Connecting a 4028 fan</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a href="https://www.klipper3d.org/" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist hasHref_VCh3">Other Documentation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://www.klipper3d.org/" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>Klipper<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://docs.mainsail.xyz/" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>Mainsail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://moonraker.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>Moonraker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://klipperscreen.readthedocs.io/" target="_blank" rel="noopener noreferrer" class="menu__link" tabindex="0"><span>KlipperScreen<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Connecting a 4028 fan</h1><p>4028 server fans are becoming a popular option for part cooling because of their light weight and great pressure and flow rates. In this guide we&#x27;ll go over how to connect one and use it for part cooling. 4-pin fans usually aren&#x27;t used in 3d printers, and many boards only provide 2-pin ports, but fear not! There&#x27;s always a way.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="power">Power<a class="hash-link" href="#power" title="Direct link to heading">​</a></h2><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</h5></div><div class="admonition-content"><p>Please read this carefully. You will fry your fan if you don&#x27;t supply the correct voltage!</p></div></div><p>The black and the red pin are for power, you need to connect these to an always on source. Since most of these are 12v, you&#x27;ll need a 12v source. Boards such as the octopus or the spider come with decent 12v rails on board so you can easily power your 4028 directly from the board via an always-on selectable voltage fan port. Simply connect the red wire to the positive terminal and the black to the negative of the always-on fan port. For other boards without a 12v option, you&#x27;ll have to use a 12V PSU or a dc/dc converter. If you go that route, be sure to connect the grounds of your 24V PSU and the 12V PSU or dc/dc converter (usually dc/dc converters have the ground pins bridged, so no need to connect the grounds).</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="pwm">PWM<a class="hash-link" href="#pwm" title="Direct link to heading">​</a></h2><p>On Delta fans the blue wire is the PWM wire, on Sanyo&#x27;s it&#x27;s the brown wire. If you&#x27;re unsure, refer to your fans datasheet. To control the 4028&#x27;s the PWM wire is fed a 5V PWM signal from the board. An easy way to do this is to hook it up to the negative terminal of the part cooling fan port (refer to your boards wiring diagram). We need to invert the logic of the fan_part_cooling_pin to generate a PWM signal the fan can understand. You can do that with the following piece of configuration in your user overrides section.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>On boards with fan voltage selection (such as the Octopus boards), the voltage doesn&#x27;t matter. The selector only changes which source the positive pin is connected to. We don&#x27;t use the positive pin, we use the negative, which is a mosfetted ground connection. </p></div></div><div class="codeBlockContainer_I0IT language-properties theme-code-block"><div class="codeBlockContent_wNvx properties"><pre tabindex="0" class="prism-code language-properties codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">[fan]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">pin: !fan_part_cooling_pin</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The wiring would look like this on an Octopus board.</p><p><img alt="Octopus 4028 Wiring" src="/assets/images/4028-octopus-af9172c3ee0af63fb29b1feb77840cf6.png" width="1170" height="552"></p><p>Further more, these fans usually want a 25khz PWM signal to function properly, although some work better with 100hz. Try both and test different fans speeds to find out what works best for your particular fan:</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="25khz-pwm-signal">25KHZ PWM Signal<a class="hash-link" href="#25khz-pwm-signal" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-properties theme-code-block"><div class="codeBlockContent_wNvx properties"><pre tabindex="0" class="prism-code language-properties codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">[fan]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">pin: !fan_part_cooling_pin</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">cycle_time: 0.00004</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="100hz-pwm-signal">100HZ PWM Signal<a class="hash-link" href="#100hz-pwm-signal" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-properties theme-code-block"><div class="codeBlockContent_wNvx properties"><pre tabindex="0" class="prism-code language-properties codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">[fan]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">pin: !fan_part_cooling_pin</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">cycle_time: 0.01</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="tachometer">Tachometer<a class="hash-link" href="#tachometer" title="Direct link to heading">​</a></h2><p>The fourth pin is the tachometer pin, this pin is used to read the RPM of the fan, which, if configured, will be displayed next to the fan speed in Mainsail. You can use any available GPIO on your board for this, if you want, or just leave it disconnected. The following config will enable the tachometer read out:</p><div class="codeBlockContainer_I0IT language-properties theme-code-block"><div class="codeBlockContent_wNvx properties"><pre tabindex="0" class="prism-code language-properties codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">[fan]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">pin: !fan_part_cooling_pin</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">cycle_time: 0.00004 # or 0.01</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">tachometer_pin: ^PD14 # Made up pin name, look up your boards pinout diagram to get the pin name for the pin you&#x27;ve chosen</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">tachometer_poll_interval: 0.0005 # will support up to a 30.000 RPM fan with 2 pulses per rotation.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Notice the <code>^</code> in front of the pin name, this is a hardware pullup which is generally necessary to read the tachometer signal. For more information on tachometer configuration, refer to the <a href="https://www.klipper3d.org/Config_Reference.html?h=tachometer#fan" target="_blank" rel="noopener noreferrer">klipper configuration reference</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="my-fan-runs-at-100-until-klipper-boots">My fan runs at 100% until klipper boots<a class="hash-link" href="#my-fan-runs-at-100-until-klipper-boots" title="Direct link to heading">​</a></h2><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Do not do this if you have the tachometer pin connected. It will potentially fry your board.</h5></div><div class="admonition-content"><p>On some fans (verified on Sanyo Denki&#x27;s) disconnecting the ground pin while 12V is connected to the fan will cause a high voltage on the tachometer pin, this can fry your mcu. Do <strong>NOT</strong> connect the tachometer pin if you do this.</p></div></div><p>This is a safety feature of server fans, they will always run at 100% until they get a PWM signal. It&#x27;s a bit annoying for 3d printer use, but there&#x27;s a way around that. You can use the negative terminal of a spare heater port to only power the fan when the board is booted, by connecting the black wire (gnd) to the negative terminal of the heater port. Since these fans run high amperages, it&#x27;s important that we use a pwm port backed by a properly rated mosfet, which is why the heater ports are perfect. Let&#x27;s say we connect the gnd wire to the second heater of our board which is controlled by the pin <code>PA9</code> (made up pin name, look up the correct pin in your boards pin diagram), the configuration would be the following:</p><div class="codeBlockContainer_I0IT language-properties theme-code-block"><div class="codeBlockContent_wNvx properties"><pre tabindex="0" class="prism-code language-properties codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">[output_pin 4028_POWER]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">pin: PA9</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">value: 1</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">shutdown_value: 0 # turn the fan power off on MCU shutdown.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Since Sep 2, 2022 there&#x27;s now an <code>enable_pin</code> in the <code>[fan]</code> section that does the same thing and on top of that it turns the fan power off if speed is 0, so now you can just do:</p><div class="codeBlockContainer_I0IT language-properties theme-code-block"><div class="codeBlockContent_wNvx properties"><pre tabindex="0" class="prism-code language-properties codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">[fan]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">pin: !fan_part_cooling_pin</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">cycle_time: 0.01</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">enable_pin: PA9</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>That&#x27;s it! Enjoy using your 4028 for excellent part cooling :)</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="my-fan-doesnt-shut-off-at-0">My fan doesn&#x27;t shut off at 0%<a class="hash-link" href="#my-fan-doesnt-shut-off-at-0" title="Direct link to heading">​</a></h2><p>See the instructions for wiring above and use the <code>enable_pin</code> like so:</p><div class="codeBlockContainer_I0IT language-properties theme-code-block"><div class="codeBlockContent_wNvx properties"><pre tabindex="0" class="prism-code language-properties codeBlock_jd64 thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#d6deeb"><span class="token plain">[fan]</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">pin: !fan_part_cooling_pin</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">cycle_time: 0.01</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">enable_pin: PA9</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>That will turn off the fan at 0%.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="bonus-what-to-look-for-in-a-4028-fan">Bonus: What to look for in a 4028 fan?<a class="hash-link" href="#bonus-what-to-look-for-in-a-4028-fan" title="Direct link to heading">​</a></h2><p>Airflow (common units: cfm, m3/h) isn&#x27;t everything, we want as much pressure we can get to effectively push the high airflow through our ducts, a good fan is balanced between airflow and pressure. Air pressure is usually expressed in inches of water (in. h2o) or pascals, there are online tools to convert between different units, so you can compare the fans before buying, just google &quot;inches of water to pascal&quot; or whatever units you need to convert.</p><p>A good performing 4028 fan will have around 25-30 CFM and over 3 inches of water. For example the <code>Delta FFB0412UHN-SM36</code> or the <code>Sanyo 9GAX0412P3S001</code>. Take a look at the datasheet for the fan and make sure it runs at low PWM levels, you don&#x27;t always want high output and it&#x27;s important that the fan you choose supports low speeds as well as high speeds. Generally you want around a maximumum RPM of 20.000-25.000 to keep the rotor light, extremely fast fans such as the twice as powerful <code>Delta PFB0412EN-E</code> needs a heavier rotor and is therefore slower to change speeds. Generally the <code>Sanyo 9GAX0412P3S001</code> is regarded as the most well rounded 4028 fan currently, but they can be hard to get, so take a look around and see what you can find, there are many options out there.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Rat-OS/RatOS/edit/master/site/docs/guides/4028.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/configuration/macros"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Configuring RatOS Macros</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#power" class="table-of-contents__link toc-highlight">Power</a></li><li><a href="#pwm" class="table-of-contents__link toc-highlight">PWM</a><ul><li><a href="#25khz-pwm-signal" class="table-of-contents__link toc-highlight">25KHZ PWM Signal</a></li><li><a href="#100hz-pwm-signal" class="table-of-contents__link toc-highlight">100HZ PWM Signal</a></li></ul></li><li><a href="#tachometer" class="table-of-contents__link toc-highlight">Tachometer</a></li><li><a href="#my-fan-runs-at-100-until-klipper-boots" class="table-of-contents__link toc-highlight">My fan runs at 100% until klipper boots</a></li><li><a href="#my-fan-doesnt-shut-off-at-0" class="table-of-contents__link toc-highlight">My fan doesn&#39;t shut off at 0%</a></li><li><a href="#bonus-what-to-look-for-in-a-4028-fan" class="table-of-contents__link toc-highlight">Bonus: What to look for in a 4028 fan?</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.d3deb709.js"></script>
<script src="/assets/js/main.a3347662.js"></script>
</body>
</html>