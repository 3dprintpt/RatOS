"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[360],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return h}});var r=t(7294);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var p=r.createContext({}),s=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},c=function(e){var n=s(e.components);return r.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(t),h=o,f=u["".concat(p,".").concat(h)]||u[h]||d[h]||a;return t?r.createElement(f,i(i({ref:n},c),{},{components:t})):r.createElement(f,i({ref:n},c))}));function h(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=u;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var s=2;s<a;s++)i[s]=t[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},9222:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return p},metadata:function(){return s},toc:function(){return c},default:function(){return u}});var r=t(3117),o=t(102),a=(t(7294),t(3905)),i=["components"],l={},p="Troubleshooting",s={unversionedId:"troubleshooting",id:"troubleshooting",title:"Troubleshooting",description:"My steppers are running backwards!",source:"@site/docs/troubleshooting.md",sourceDirName:".",slug:"/troubleshooting",permalink:"/docs/troubleshooting",editUrl:"https://github.com/Rat-OS/RatOS/edit/master/site/docs/troubleshooting.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Slicer Configuration",permalink:"/docs/slicers"},next:{title:"Manual Firmware Compilation",permalink:"/docs/manual-firmware-compilation"}},c=[{value:"My steppers are running backwards!",id:"my-steppers-are-running-backwards",children:[],level:2},{value:"Everytime i update my changes are gone.",id:"everytime-i-update-my-changes-are-gone",children:[],level:2},{value:"Klipper says the MCU is unable to connect",id:"klipper-says-the-mcu-is-unable-to-connect",children:[],level:2},{value:"I updated klipper and now i get an error!",id:"i-updated-klipper-and-now-i-get-an-error",children:[],level:2},{value:"Unparsed config option &#39;config_path: ~/klipper_config&#39; detected in section [server]",id:"unparsed-config-option-config_path-klipper_config-detected-in-section-server",children:[],level:2},{value:"Section &#39;gcode_shell_command generate_shaper_graph_x&#39; is not a valid config section",id:"section-gcode_shell_command-generate_shaper_graph_x-is-not-a-valid-config-section",children:[],level:2},{value:"Connection to moonraker failed",id:"connection-to-moonraker-failed",children:[],level:2},{value:"Get help",id:"get-help",children:[],level:2}],d={toc:c};function u(e){var n=e.components,l=(0,o.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},d,l,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"troubleshooting"},"Troubleshooting"),(0,a.kt)("h2",{id:"my-steppers-are-running-backwards"},"My steppers are running backwards!"),(0,a.kt)("p",null,"Refer to the stepper section at the top of printer.cfg, you can add or remove ",(0,a.kt)("inlineCode",{parentName:"p"},"!")," in front of the dir_pin to reverse the direction of that particular stepper."),(0,a.kt)("h2",{id:"everytime-i-update-my-changes-are-gone"},"Everytime i update my changes are gone."),(0,a.kt)("p",null,"You're not supposed to change ",(0,a.kt)("em",{parentName:"p"},"any")," files inside the managed RatOS config/ folder. You should ",(0,a.kt)("em",{parentName:"p"},"only")," change your printer.cfg, if you need to change settings refer to the ",(0,a.kt)("a",{parentName:"p",href:"/docs/configuration/includes-and-overrides"},"Inlcudes & Overrides Documentation")," section.\n",(0,a.kt)("img",{alt:"Hands off the RatOS Managed Config Folder!",src:t(2620).Z,width:"894",height:"590"})),(0,a.kt)("h2",{id:"klipper-says-the-mcu-is-unable-to-connect"},"Klipper says the MCU is unable to connect"),(0,a.kt)("p",null,"Double check your USB connection, try another cable (the one that comes with the board usually works), and check that your firmware was flashed correctly (refer to the guide for your board).\nIf you need to flash new firmware (for example autoflashing will not work if you upgrade klipper before flashing your board and it's properly connected), use the ",(0,a.kt)("inlineCode",{parentName:"p"},"COMPILE_BINARIES")," macro to generate new firmware binaries for all supported boards. Then download the binary for your board from the ",(0,a.kt)("inlineCode",{parentName:"p"},"firmware_binaries")," folder in the Machine tab, and flash it via SD card."),(0,a.kt)("h2",{id:"i-updated-klipper-and-now-i-get-an-error"},"I updated klipper and now i get an error!"),(0,a.kt)("p",null,"When you update klipper you might see an error that looks like this:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Firmware version mismatch between host and guest",src:t(1240).Z,width:"849",height:"260"})),(0,a.kt)("p",null,"This is because klipper made changes to a part of the MCU firmware that we use. Klipper is telling us that the version of klipper running on the Pi is newer than the version running on the MCU. To fix this, we have to flash the board with a new version of the firmware. For convenience, and ease of use, the newest firmware is compiled and put in the ",(0,a.kt)("inlineCode",{parentName:"p"},"firmware_binaries")," folder which you can find in the ",(0,a.kt)("inlineCode",{parentName:"p"},"MACHINE")," tab in Mainsail. You can use this to flash your MCU the same way you did initially, via SD Card. RatOS attempts to flash supported boards automatically when klipper is updated. If you're getting this error you're probably using a board which does not support automatic flashing via USB. It's also possible that you updated klipper without having your board flashed and connected. In that case, use the ",(0,a.kt)("inlineCode",{parentName:"p"},"COMPILE_BINARIES")," macro to generate new firmware binaries for all supported boards. Then download the binary for your board from the ",(0,a.kt)("inlineCode",{parentName:"p"},"firmware_binaries")," folder in the Machine tab, and flash that via SD card."),(0,a.kt)("h2",{id:"unparsed-config-option-config_path-klipper_config-detected-in-section-server"},"Unparsed config option 'config_path: ~/klipper_config' detected in section ","[","server","]"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Unparsed config option",src:t(2767).Z,width:"1000",height:"692"}),"\nThis happens because moonraker has moved ",(0,a.kt)("inlineCode",{parentName:"p"},"config_path")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"log_path")," from the ",(0,a.kt)("inlineCode",{parentName:"p"},"[server]")," section to the ",(0,a.kt)("inlineCode",{parentName:"p"},"[file_manager]")," section. You can fix this by moving those to options into the ",(0,a.kt)("inlineCode",{parentName:"p"},"[file_manager]")," (create it if it doesn't already exist) in moonraker.conf."),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-properties"},"[server]\nhost = 0.0.0.0\nport = 7125\nenable_debug_logging = False\nconfig_path = ~/klipper_config\nlog_path = ~/klipper_logs\n")),(0,a.kt)("p",null,"becomes"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-properties"},"[server]\nhost = 0.0.0.0\nport = 7125\nenable_debug_logging = False\n\n[file_manager]\nconfig_path = ~/klipper_config\nlog_path = ~/klipper_logs\n")),(0,a.kt)("p",null,"You may have to ssh into your raspberry pi and edit the file with nano:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"ssh pi@ratos.local\nnano ~/klipper_config/moonraker.conf\n")),(0,a.kt)("p",null,"Use ctrl+o to write your changes to moonraker.conf and then ctrl+x to exit nano. Then run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"sudo systemctl restart moonraker\n")),(0,a.kt)("p",null,"And you should be back in action."),(0,a.kt)("h2",{id:"section-gcode_shell_command-generate_shaper_graph_x-is-not-a-valid-config-section"},"Section 'gcode_shell_command generate_shaper_graph_x' is not a valid config section"),(0,a.kt)("p",null,"This happens if you've somehow hard reset klipper through the update manager. To restore the gcode_shell_command extension, you'll need to put ",(0,a.kt)("a",{parentName:"p",href:"https://raw.githubusercontent.com/Rat-OS/RatOS/master/src/modules/ratos/filesystem/home/pi/klipper/klippy/extras/gcode_shell_command.py"},"the gcode_shell_extension klipper plugin")," into ",(0,a.kt)("inlineCode",{parentName:"p"},"~/klipper/klippy/extras")," on your pi. You can do that via either SSH or SCP."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"SSH")),(0,a.kt)("p",null,"Open the command prompt or terminal on your machine, and log in to your pi (default user is pi, default password is raspberry). If you don't have SSH on your Windows machine, download PuTTy."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"ssh ratos.local\ntouch ~/klipper/klippy/extras/gcode_shell_command.py\nnano ~/klipper/klippy/extras/gcode_shell_command.py\n")),(0,a.kt)("p",null,"Then paste in the contents of the gcode_shell_extension plugin, and save the file. The restart klipper by running."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"sudo service klipper restart\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"SCP")),(0,a.kt)("p",null,"Go download WinSCP or similar, and connect to ratos.local (or your IP). Then you can navigate to /home/pi/klipper/klippy/extras and then just upload the file there."),(0,a.kt)("h2",{id:"connection-to-moonraker-failed"},"Connection to moonraker failed"),(0,a.kt)("p",null,"If you see the mainsail interface but you get an error about the connecting to moonraker, the connection to the pi is fine, but you're using a non standard IPv4 or IPv6 range that is not whitelisted in moonraker (only standard local ip ranges are whitelisted for security reasons). Try using the ip address of your pi (look it up in your routers admin interface) instead of ratos.local, or fix it by adding your IP range in CIDR notation to the ",(0,a.kt)("inlineCode",{parentName:"p"},"[authorization]")," section in ~/klipper_config/moonraker.conf on the pi. You can do that through SSH, by running: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"ssh ratos.local\nnano ~/klipper_config/moonraker.conf\nsudo systemctl restart moonraker\n")),(0,a.kt)("p",null,"Alternatively you can delete the entire ",(0,a.kt)("inlineCode",{parentName:"p"},"[authorization]")," section, which will allow anyone to connect to moonraker (this is insecure, so do not do this if your network is open to - our your pi is reachable by - the outside world)"),(0,a.kt)("h2",{id:"get-help"},"Get help"),(0,a.kt)("p",null,"For further support check out the RatOS-support and klipper channels on Discord. Use the invite link below to join."),(0,a.kt)("a",{href:"https://discord.gg/ratrig",class:"button button--primary"},"Join the Unnofficial RatRig Discord Community"))}u.isMDXComponent=!0},2620:function(e,n,t){n.Z=t.p+"assets/images/config-folder-783bb1478f027bfd6ad4aab7505bc287.png"},1240:function(e,n,t){n.Z=t.p+"assets/images/firmware_version_mismatch-456c9561ecf03b8fc5c498f42ce6a891.png"},2767:function(e,n,t){n.Z=t.p+"assets/images/moonraker_unparsed_config-eb4c0f2b6c16094920135b33fe1192f3.png"}}]);